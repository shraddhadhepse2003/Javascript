"use strict";var ATFmapping,MTFmapping,MTF300mapping,MTFBoxR320mapping,HTmapping,compareAdBrand=(window.idleCb(function(){getScript("https://securepubads.g.doubleclick.net/tag/js/gpt.js")}),[]),compareAdModel=[],compareAdVariant=[],googletag=googletag||{},cityAdTarget=(googletag.cmd=googletag.cmd||[],"New-Delhi"),mediaAdtargetting="",connectoSegments=(window.objSegmentData={},window.connectoSegmentsData={},{tempSegmentDataObj:[],arrayJoinAttrVal:[],valueToPass:"",init:function(e){this.insertDataIntoIndexDB(),this.setAdTargetFromSegments(e)},insertDataIntoIndexDB:function(){var e,a,t=this,n=!1,i=localStorage.getItem("connectoSgmtCurDateTme");(n=!i||(e=new Date,i=Date.parse(i),2<parseInt((e-i)/864e5))?!0:n)&&((a=new XMLHttpRequest).open("get","https://api.connecto.io/getSegmentDefinitionsByProject?projectId=570de84a4f0d925f98343571&type=online",!0),a.send(),a.onreadystatechange=function(){4==this.readyState&&200==this.status&&t.createConnectoSegmentDB(a.response)})},createConnectoSegmentDB:function(o){var r,e=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;e&&((r=e.open("cardekho_connecto",1)).onupgradeneeded=function(e){var a=r.result;e.oldVersion<1&&a.createObjectStore("segments",{keyPath:"_id"})},r.onsuccess=function(e){var a=r.result;try{var t=a.transaction(["segments"],"readwrite").objectStore("segments"),n=t.clear(),i=JSON.parse(o);n.onsuccess=function(e){for(var a in i)t.add(i[a]);localStorage.setItem("connectoSgmtCurDateTme",new Date)}}catch(e){}})},setAdTargetFromSegments:function(e){var a=this;a.tempSegmentDataObj=[],a.arrayJoinAttrVal=[],a.valueToPass="";try{window._jpConnecto=JSON.parse(localStorage.getItem("_Connecto"))}catch(e){window._jpConnecto={}}if(null==window._jpConnecto||0==Object.keys(window._jpConnecto).length)e(setDefaultAdTargetting());else if(0==Object.keys(window.connectoSegmentsData).length)a.setAdTargetBySegmentsFromDb(e);else{for(var t in window.connectoSegmentsData)a.evaluateSegments(t,window.connectoSegmentsData[t]);window.objSegmentData=a.tempSegmentDataObj,e(setDefaultAdTargetting(a.tempSegmentDataObj))}},evaluateSegments:function(id,evalFunction){var self=this;if(evalFunction){var evalResult=eval(evalFunction);if(void 0!==evalResult&&null!=evalResult.result)if(evalResult.result&&null!=evalResult.attrDetails){for(var j=0;j<evalResult.attrDetails.length;j++)self.arrayJoinAttrVal.push(evalResult.attrDetails[j].joinAttrVal);self.tempSegmentDataObj.push({key:id.substring(0,20)+"",value:self.arrayJoinAttrVal}),self.arrayJoinAttrVal=[]}else self.valueToPass=evalResult.result,self.tempSegmentDataObj.push({key:id.substring(0,20)+"",value:self.valueToPass+""});else self.valueToPass=evalResult,self.tempSegmentDataObj.push({key:id.substring(0,20)+"",value:self.valueToPass+""})}},callbackForConnectoSegment:function(e){void 0!==e&&void 0!==e._id&&void 0!==e.evalFunction&&(window.connectoSegmentsData[e._id.toString()+""]=e.evalFunction,this.evaluateSegments(e._id,e.evalFunction))},setAdTargetBySegmentsFromDb:function(t){var n,i=this,e=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;void 0===e?t(setDefaultAdTargetting()):((n=e.open("cardekho_connecto")).onerror=function(e){t(setDefaultAdTargetting())},n.onupgradeneeded=function(e){var a=n.result;e.oldVersion<1&&a.createObjectStore("segments",{keyPath:"_id"})},n.onsuccess=function(){performance.now();var e=n.result.transaction(["segments"],"readonly"),a=e.objectStore("segments"),e=(e.oncomplete=function(e){window.objSegmentData=i.tempSegmentDataObj,t(setDefaultAdTargetting(i.tempSegmentDataObj))},a.openCursor());e.onerror=function(e){console.log(e)},e.onsuccess=function(e){e=e.target.result;e&&(i.callbackForConnectoSegment(e.value),e.continue())}})}}),customOffers={getFieldValue:function(e,a){var t=null,e=JSON.parse(localStorage.getItem("user_custom_offer"))[e];return t=null!=e?e[a]:t},getStatus:function(e){var a=this.getFieldValue(e,"lock_value"),t=this.getFieldValue(e,"payment_status"),e=this.getFieldValue(e,"i_m_intrested");return null==a?"unlocked":1==t?"payment_made":e?"intrested":"unlocked"},setTargettingForCustomOffers:function(e){var a=JSON.parse(localStorage.getItem("user_custom_offer"));try{if(null!=a)for(var t in a){var n=t,i=a[n];e.push({key:"o_"+n+"_status",value:this.getStatus(n)}),e.push({key:"o_"+n+"_value",value:null!=i.offer_value?""+i.offer_value:""}),e.push({key:"o_"+n+"_dd",value:null!=i.dealer_discount?""+i.dealer_discount:""}),e.push({key:"o_"+n+"_mdd",value:null!=i.max_dealer_discount?""+i.max_dealer_discount:""})}return e}catch(e){return[]}}};function loadAd(){if(1==googletag.pubadsReady)try{var o={box:[[300,250],[336,280]],minibox:[300,114],box320:[320,100],boxR320:[320,100],banner:[970,90],minibanner:[728,90],banner728:[[728,90],[970,90]],box600:[[300,250],[300,600]],fluid:["fluid"],banner300:[970,90],pixelTracking:[1,1],box300:[300,100],box50:[320,50],fluidB300:[[728,90],[300,250],"fluid"],mini163x33:[163,33],mini136x26:[136,26],box100:[[320,50],[320,100]],box280:[[320,50],[320,100],[300,250],[336,280]],box280Fluid:[[320,50],[320,100],[300,250],[336,280],"fluid"],box300x250:[300,250]},r=[];googletag.cmd.push(function(){null==ATFmapping&&(ATFmapping=googletag.sizeMapping().addSize([1024,0],[970,90]).addSize([750,0],[728,90]).addSize([320,0],[320,100]).addSize([0,0],[320,100]).build(),MTFmapping=googletag.sizeMapping().addSize([1024,0],[728,90]).addSize([750,0],[728,90]).addSize([320,0],[300,250]).addSize([0,0],[300,250]).build(),MTF300mapping=googletag.sizeMapping().addSize([1024,0],[970,90]).addSize([750,0],[728,90]).addSize([320,0],[300,250]).addSize([0,0],[300,250]).build(),MTFBoxR320mapping=googletag.sizeMapping().addSize([1024,0],[728,90]).addSize([750,0],[728,90]).addSize([320,0],[320,100]).addSize([0,0],[320,100]).build(),HTmapping=googletag.sizeMapping().addSize([0,0],[1,1]).build()),document.querySelectorAll('[data-load-initially="true"]').forEach(function(e){e.removeAttribute("data-load-initially");var a,t=e.getAttribute("id"),n=e.dataset.slotDef,i=e.dataset.type;if(a="size"==i?(e=JSON.parse(e.dataset.size),googletag.defineSlot(n,e,t)):googletag.defineSlot(n,o[i],t),n&&a){switch(i){case"banner":a.defineSizeMapping(ATFmapping);break;case"minibanner":a.defineSizeMapping(MTFmapping);break;case"banner300":a.defineSizeMapping(MTF300mapping);break;case"boxR320":a.defineSizeMapping(MTFBoxR320mapping);break;case"pixelTracking":a.defineSizeMapping(HTmapping)}googletag.display(t),isEmptyObject(a)||r.push(a.addService(googletag.pubads()))}}),0<r.length&&googletag.pubads().refresh(r)})}catch(e){console.log(e)}}function isEmptyObject(e){try{return void 0===e||null==e||0==Object.keys(e).length?!("Array"==typeof e&&0<e.length):!1}catch(e){return!0}}function setDefaultAdTargetting(e){var a=[];if(dataLayerObj.length<=0){if(!(0<dataLayer.length))return[];dataLayerObj=dataLayer[0]}if(a=customOffers.setTargettingForCustomOffers(a),null!=typeof e&&""!=e&&a.push.apply(a,e),"undefined"!=typeof dataLayerObj){void 0!==dataLayerObj.engine_capacity_new&&""!=dataLayerObj.engine_capacity_new&&a.push({key:"engine_capacity",value:dataLayerObj.engine_capacity_new}),void 0!==dataLayerObj.transmission_type_new&&""!=dataLayerObj.transmission_type_new&&a.push({key:"transmission_type_new",value:dataLayerObj.transmission_type_new}),void 0!==location.hostname&&""!=location.hostname&&a.push({key:"domain",value:location.hostname}),void 0!==dataLayerObj.city&&""!=dataLayerObj.city?a.push({key:"city",value:dataLayerObj.city.replace(/\(/g,"_").replace(/\s|\)/g,"")}):a.push({key:"city",value:cityAdTarget.replace(new RegExp(" ","g"),"_")});try{($.gsp_cookie.readWrite("CityId")&&0==$.gsp_cookie.readWrite("CityId").length||""==$.gsp_cookie.readWrite("CityId"))&&a.push({key:"defaultCity",value:"1"})}catch(e){}if(void 0!==dataLayerObj.car_segment&&""!=dataLayerObj.car_segment&&a.push({key:"car_segment",value:dataLayerObj.car_segment}),void 0!==dataLayerObj.model_type_new&&""!=dataLayerObj.model_type_new&&a.push({key:"model_type_new",value:dataLayerObj.model_type_new}),void 0!==dataLayerObj.oem_name&&""!=dataLayerObj.oem_name&&a.push({key:"Brand",value:dataLayerObj.oem_name}),void 0!==dataLayerObj.model_name&&""!=dataLayerObj.model_name&&(a.push({key:"Model",value:dataLayerObj.model_name.replace(new RegExp(" ","g"),"_")}),void 0!==dataLayerObj.variant_name)&&""!=dataLayerObj.variant_name&&a.push({key:"Variant",value:dataLayerObj.variant_name.replace(/-|\s/g,"_").replace(/[^a-zA-Z0-9_ ]/g,"")}),void 0!==dataLayerObj.price_segment_new&&""!=dataLayerObj.price_segment_new?a.push({key:"price",value:dataLayerObj.price_segment_new}):void 0!==dataLayerObj.price_range_segment&&""!=dataLayerObj.price_range_segment&&a.push({key:"price",value:setRangeForPriceSegmentNew(dataLayerObj.price_range_segment)}),void 0!==dataLayerObj.dealer_id&&""!=dataLayerObj.dealer_id&&a.push({key:"dealer_id",value:dataLayerObj.dealer_id}),void 0!==dataLayerObj.news_id_new&&""!=dataLayerObj.news_id_new&&a.push({key:"news_id",value:dataLayerObj.news_id_new}),void 0!==dataLayerObj.fuel_type_new&&""!=dataLayerObj.fuel_type_new&&a.push({key:"fuel_type",value:dataLayerObj.fuel_type_new.replace("(","_").replace(")","")}),void 0!==dataLayerObj.source&&""!=dataLayerObj.source&&(mediaAdtargetting=dataLayerObj.source.toUpperCase()),void 0!==dataLayerObj.page_type&&""!=dataLayerObj.page_type&&a.push({key:"PageType",value:dataLayerObj.page_type}),void 0!==dataLayerObj.compare_car_details&&""!=dataLayerObj.compare_car_details){for(var t=0;t<dataLayerObj.compare_car_details.split(",").length;t++)compareAdBrand.push(dataLayerObj.compare_car_details.split(",")[t].split("_")[0]),compareAdModel.push(dataLayerObj.compare_car_details.split(",")[t].split("_")[1].replace(new RegExp(" ","g"),"_")),compareAdVariant.push(dataLayerObj.compare_car_details.split(",")[t].split("_")[1].replace(new RegExp(" ","g"),"_")+"_"+dataLayerObj.compare_car_details.split(",")[t].split("_")[2].replace(new RegExp(" ","g"),"_"));""!=compareAdBrand&&a.push({key:"Brand",value:compareAdBrand}),""!=compareAdModel&&(a.push({key:"Model",value:compareAdModel}),""!=compareAdVariant)&&a.push({key:"Variant",value:compareAdVariant})}}else console.error("DataLayer is undefined");return""!=mediaAdtargetting&&null!=mediaAdtargetting&&a.push({key:"gptMedia",value:mediaAdtargetting}),a}function setRangeForPriceSegmentNew(e){if("undefined"==e||!e.includes("lakh")&&!e.includes("crore"))return e;for(var a=e.split(","),t=[],n=0;n<a.length;n++)t.push(a[n].replace("lakh","").replace("lakh","L").replace("+crore","Cabove").replace("crore","C"));return t}function setRangeForPriceSegment(e){return e<=3e5?"upto3L":e<=6e5?"3-6L":e<=12e5?"6-12L":e<=15e5?"12-15L":e<=2e6?"15-20L":"20Labove"}function hideEmptySlotAd(e){var a,e=document.getElementById(e.slot.getSlotElementId());e&&setDynmicImageBanner(a=e.parentNode.closest("aside"),a.clientHeight,e)}function adLoaded(e){var a,t,n,e=document.getElementById(e.slot.getSlotElementId());e&&(a=e.parentNode.closest("aside"),t=e.clientHeight,1<(n=a.clientHeight)&&n<t&&a.classList.add("alignTop"),e)&&a.classList.add("adLoaded")}function setDynmicImageBanner(e,a,t){var n,i,o=e.getAttribute("data-placeholder"),r=t.getAttribute("data-slot-def"),d=e.getAttribute("data-source"),s=e.getAttribute("data-viewtracking");o?(n=document.createElement("img"),i={src:o,width:"auto",height:a},Object.keys(i).forEach(function(e){n.setAttribute(e,i[e])}),e.classList.add("adLoaded"),t.classList.add("hide"),e.appendChild(n),"true"==s&&dataLayer.push({event:"pwaClick",pwaComponentName:"inhouse-banner-impression",pwaAction:"view",pwaLinkLabel:r,source:d,is_online:"yes"})):e.classList.add("hide")}window.addEventListener("load",connectoSegments.init(function(a){var t;googletag.cmd.push(function(){googletag.pubads().set("page_url",location.href),googletag.pubads().disableInitialLoad(),googletag.pubads().setCentering(!0);for(var e=0;e<a.length;e++)googletag.pubads().setTargeting(a[e].key,a[e].value);googletag.pubads().addEventListener("slotRenderEnded",function(e){(e.isEmpty?hideEmptySlotAd:adLoaded)(e)}),t=setInterval(function(){googletag.pubadsReady&&(loadAd(),clearInterval(t))},10),googletag.pubads().enableSingleRequest(),googletag.enableServices()})}),!1);